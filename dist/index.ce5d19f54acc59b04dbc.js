!function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function i(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var r=function(){function t(n){e(this,t),o(this,"cells",[]),this.canvas=n,this.context=this.canvas.getContext("2d")}return i(t,[{key:"createGrid",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;this.clearGrid();for(var e=0;e<this.canvas.width;e+=t)for(var n=0;n<this.canvas.height;n+=t)this.context.strokeRect(e,n,t,t),this.cells.push(new a(e,n,t,this))}},{key:"clearGrid",value:function(){this.cells=[],this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"onClick",value:function(t){var e=this;this.canvas.addEventListener("click",(function(n){e.cells.forEach((function(e){var i=[e.x,e.x+e.size,e.y,e.y+e.size],o=i[0],r=i[1],a=i[2],s=i[3];n.offsetX>=o&&n.offsetX<=r&&n.offsetY>=a&&n.offsetY<=s&&t(e)}))}))}}]),t}(),a=function(){function t(n,i,r,a){e(this,t),o(this,"isPaint",!1),this.x=n,this.y=i,this.size=r,this.painter=a}return i(t,[{key:"paint",value:function(){this.painter.context.fillRect(this.x,this.y,this.size,this.size),this.isPaint=!0}},{key:"unpaint",value:function(){this.painter.context.clearRect(this.x,this.y,this.size,this.size),this.painter.context.strokeRect(this.x,this.y,this.size,this.size),this.isPaint=!1}},{key:"getNeighbors",value:function(){var t=this;return this.painter.cells.reduce((function(e,n){return n===t||n.x-t.x<=t.size&&n.x-t.x>=-t.size&&n.y-t.y<=t.size&&n.y-t.y>=-t.size&&e.push(n),e}),[])}},{key:"getPaintNeighbors",value:function(){return this.getNeighbors().reduce((function(t,e){return e.isPaint&&t.push(e),t}),[])}}]),t}(),s=new r(document.querySelector("#canvas"));function c(){var t;window.generationCount=null!==(t=window.generationCount)&&void 0!==t?t:0,window.generationCount++,document.querySelector(".sidebar__item_generation-count").textContent=window.generationCount;var e=[];s.cells.forEach((function(t){var n=new a(t.x,t.y,t.size,s),i=t.getPaintNeighbors().length;!t.isPaint&&3===i||t.isPaint&&(2===i||3===i)?n.paint():t.isPaint&&(i<2||i>3)&&n.unpaint(),e.push(n)})),s.cells=e,s.cells.forEach((function(t){t.isPaint?t.paint():t.unpaint()})),s.cells.reduce((function(t,e){return e.isPaint&&t++,t}),0)<=0&&(window.generationCount=0,clearInterval(window.gameVendor),alert("Игра окончена"))}function l(e,n){var i=document.querySelector(e);if(n.hasOwnProperty("init")&&"function"==typeof n.init&&n.init(i),n.hasOwnProperty("events")&&"object"===t(n.events))for(var o in n.events)if(n.events.hasOwnProperty(o)){if("string"!=typeof o||!o.includes("on"))break;var r=o.substr(2).toLowerCase();i.addEventListener(r,n.events[o])}}l("#cell-size",{init:function(t){var e;t.value=null!==(e=localStorage.getItem("cell-size"))&&void 0!==e?e:50,s.createGrid(+t.value)},events:{onInput:function(t){var e=parseInt(t.target.value);e&&e>=10&&(localStorage.setItem("cell-size",e.toString()),s.createGrid(e))}}}),l("#interval-generation",{init:function(t){var e;t.value=null!==(e=localStorage.getItem("interval-generation"))&&void 0!==e?e:500},events:{onInput:function(t){var e=parseInt(t.target.value);e&&localStorage.setItem("interval-generation",e.toString())}}}),l("#generation-cells",{events:{onClick:function(){s.cells.forEach((function(t){t.unpaint(),Math.random()<.3&&t.paint()}))}}}),l("#stop-game",{events:{onClick:function(){window.gameVendor&&clearInterval(window.gameVendor)}}}),l("#clear-game",{events:{onClick:function(){var t,e=null!==(t=localStorage.getItem("cell-size"))&&void 0!==t?t:50;s.createGrid(+e)}}}),document.querySelector("#start-game").addEventListener("click",(function(){var t,e=null!==(t=localStorage.getItem("interval-generation"))&&void 0!==t?t:500;window.gameVendor=setInterval(c,e)})),s.onClick((function(t){t.paint()}))}();